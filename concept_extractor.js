const fs = require('fs');
const path = require('path');

// æ”¿æ²»ç†è®ºæ ¸å¿ƒæ¦‚å¿µåº“ - åŸºäºå¸¸è§æ”¿æ²»ç†è®ºæœ¯è¯­
const politicalConceptPatterns = {
    // é©¬å…‹æ€ä¸»ä¹‰åŸºæœ¬æ¦‚å¿µ
    marxism: [
        'é©¬å…‹æ€ä¸»ä¹‰', 'å”¯ç‰©ä¸»ä¹‰', 'è¾©è¯æ³•', 'å†å²å”¯ç‰©ä¸»ä¹‰', 'ç”Ÿäº§åŠ›', 'ç”Ÿäº§å…³ç³»',
        'ç»æµåŸºç¡€', 'ä¸Šå±‚å»ºç­‘', 'é˜¶çº§æ–—äº‰', 'æ— äº§é˜¶çº§', 'èµ„äº§é˜¶çº§', 'å‰©ä½™ä»·å€¼',
        'èµ„æœ¬', 'å•†å“', 'ä»·å€¼', 'ä½¿ç”¨ä»·å€¼', 'äº¤æ¢ä»·å€¼', 'åŠ³åŠ¨ä»·å€¼è®º', 'å‰©ä½™ä»·å€¼ç†è®º',
        'å¼‚åŒ–', 'å…±äº§ä¸»ä¹‰', 'ç¤¾ä¼šä¸»ä¹‰', 'èµ„æœ¬ä¸»ä¹‰', 'æ‰€æœ‰åˆ¶', 'å…¬æœ‰åˆ¶', 'ç§æœ‰åˆ¶',
        'ç¤¾ä¼šå½¢æ€', 'ç”Ÿäº§æ–¹å¼', 'åŠ³åŠ¨åˆ†å·¥', 'ç‰©è´¨èµ„æ–™', 'ç”Ÿäº§èµ„æ–™', 'åŠ³åŠ¨èµ„æ–™',
        'åŠ³åŠ¨å¯¹è±¡', 'ç¤¾ä¼šå®è·µ', 'è®¤è¯†è®º', 'çœŸç†', 'å®è·µ', 'æ„Ÿæ€§è®¤è¯†', 'ç†æ€§è®¤è¯†',
        'æ„è¯†', 'ç‰©è´¨', 'è¿åŠ¨', 'æ—¶é—´', 'ç©ºé—´', 'çŸ›ç›¾', 'å¯¹ç«‹ç»Ÿä¸€', 'é‡å˜', 'è´¨å˜',
        'å¦å®šä¹‹å¦å®š', 'è§„å¾‹', 'è”ç³»', 'å‘å±•', 'äººæ°‘ç¾¤ä¼—', 'å†å²åˆ›é€ è€…', 'ç¤¾ä¼šå­˜åœ¨',
        'ç¤¾ä¼šæ„è¯†', 'æ–‡åŒ–', 'æ„è¯†å½¢æ€', 'å›½å®¶', 'æ”¿å…š', 'æ°‘ä¸»', 'æ³•æ²»', 'è‡ªç”±',
        'å¹³ç­‰', 'æ­£ä¹‰', 'å…¬å¹³', 'æ•ˆç‡', 'æ”¹é©', 'é©å‘½', 'å‘å±•', 'åˆ›æ–°'
    ],

    // æ¯›æ³½ä¸œæ€æƒ³ç›¸å…³æ¦‚å¿µ
    maoThought: [
        'æ¯›æ³½ä¸œæ€æƒ³', 'å®äº‹æ±‚æ˜¯', 'ç¾¤ä¼—è·¯çº¿', 'ç‹¬ç«‹è‡ªä¸»', 'æ–°æ°‘ä¸»ä¸»ä¹‰é©å‘½',
        'ç¤¾ä¼šä¸»ä¹‰æ”¹é€ ', 'ç¤¾ä¼šä¸»ä¹‰å»ºè®¾', 'äººæ°‘æ°‘ä¸»ä¸“æ”¿', 'ç»Ÿä¸€æˆ˜çº¿', 'æ­¦è£…æ–—äº‰',
        'å…šçš„å»ºè®¾', 'å†œæ‘åŒ…å›´åŸå¸‚', 'æªæ†å­é‡Œå‡ºæ”¿æƒ', 'æ˜Ÿæ˜Ÿä¹‹ç«å¯ä»¥ç‡åŸ',
        'è®ºæŒä¹…æˆ˜', 'çŸ›ç›¾è®º', 'å®è·µè®º', 'ä¸ºäººæ°‘æœåŠ¡', 'ç¾¤ä¼—è¿åŠ¨', 'è°ƒæŸ¥ç ”ç©¶',
        'é˜¶çº§åˆ†æ', 'æ•´é£è¿åŠ¨', 'æ‰¹è¯„ä¸è‡ªæˆ‘æ‰¹è¯„', 'æ°‘ä¸»é›†ä¸­åˆ¶', 'é›†ä½“é¢†å¯¼',
        'ç™¾èŠ±é½æ”¾ç™¾å®¶äº‰é¸£', 'åˆçº¢åˆä¸“', 'å››ä¸ªç°ä»£åŒ–', 'ä¸¤å‚ä¸€æ”¹ä¸‰ç»“åˆ'
    ],

    // ä¹ è¿‘å¹³æ–°æ—¶ä»£ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰æ€æƒ³
    xiThought: [
        'ä¹ è¿‘å¹³æ–°æ—¶ä»£ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰æ€æƒ³', 'ä¸­å›½æ¢¦', 'ä¸¤ä¸ªä¸€ç™¾å¹´å¥‹æ–—ç›®æ ‡',
        'äº”ä½ä¸€ä½“æ€»ä½“å¸ƒå±€', 'å››ä¸ªå…¨é¢æˆ˜ç•¥å¸ƒå±€', 'æ–°å‘å±•ç†å¿µ', 'é«˜è´¨é‡å‘å±•',
        'ä¾›ç»™ä¾§ç»“æ„æ€§æ”¹é©', 'å…¨é¢æ·±åŒ–æ”¹é©', 'å…¨é¢ä¾æ³•æ²»å›½', 'å…¨é¢ä»ä¸¥æ²»å…š',
        'äººç±»å‘½è¿å…±åŒä½“', 'ä¸€å¸¦ä¸€è·¯', 'æ–°å‹å›½é™…å…³ç³»', 'å…¨çƒæ²»ç†', 'ä¸­å›½æ–¹æ¡ˆ',
        'æ–‡åŒ–è‡ªä¿¡', 'é“è·¯è‡ªä¿¡', 'ç†è®ºè‡ªä¿¡', 'åˆ¶åº¦è‡ªä¿¡', 'å››ä¸ªè‡ªä¿¡',
        'ä¸¤ä¸ªç»´æŠ¤', 'å››ä¸ªæ„è¯†', 'æ”¿æ²»å»ºè®¾', 'æ€æƒ³å»ºè®¾', 'ç»„ç»‡å»ºè®¾', 'ä½œé£å»ºè®¾',
        'çºªå¾‹å»ºè®¾', 'åè…è´¥æ–—äº‰', 'å·¡è§†å·¡å¯Ÿ', 'ç›‘å¯Ÿä½“åˆ¶æ”¹é©', 'å›½å®¶æ²»ç†ä½“ç³»',
        'æ²»ç†èƒ½åŠ›ç°ä»£åŒ–', 'ç¾ä¸½ä¸­å›½', 'ç”Ÿæ€æ–‡æ˜', 'ç»¿è‰²å‘å±•', 'ç¢³è¾¾å³°ç¢³ä¸­å’Œ',
        'å…±åŒå¯Œè£•', 'ä¹¡æ‘æŒ¯å…´', 'åŒºåŸŸåè°ƒå‘å±•', 'åˆ›æ–°é©±åŠ¨å‘å±•', 'ç§‘æ•™å…´å›½',
        'äººæ‰å¼ºå›½', 'å¥åº·ä¸­å›½', 'å¹³å®‰ä¸­å›½', 'æ³•æ²»ä¸­å›½', 'æ•°å­—ä¸­å›½'
    ],

    // ä¸­å›½è¿‘ç°ä»£å²æ¦‚å¿µ
    modernHistory: [
        'é¸¦ç‰‡æˆ˜äº‰', 'å¤ªå¹³å¤©å›½è¿åŠ¨', 'æ´‹åŠ¡è¿åŠ¨', 'æˆŠæˆŒå˜æ³•', 'ä¹‰å’Œå›¢è¿åŠ¨',
        'è¾›äº¥é©å‘½', 'äº”å››è¿åŠ¨', 'æ–°æ–‡åŒ–è¿åŠ¨', 'ä¸­å›½å…±äº§å…šæˆç«‹', 'ç¬¬ä¸€æ¬¡å›½å…±åˆä½œ',
        'åŒ—ä¼æˆ˜äº‰', 'åœŸåœ°é©å‘½æˆ˜äº‰', 'é•¿å¾', 'æŠ—æ—¥æˆ˜äº‰', 'è§£æ”¾æˆ˜äº‰', 'ä¸­åäººæ°‘å…±å’Œå›½æˆç«‹',
        'æŠ—ç¾æ´æœ', 'åœŸåœ°æ”¹é©', 'ä¸‰å¤§æ”¹é€ ', 'å¤§è·ƒè¿›', 'äººæ°‘å…¬ç¤¾', 'æ–‡åŒ–å¤§é©å‘½',
        'æ”¹é©å¼€æ”¾', 'ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰', 'ç¤¾ä¼šä¸»ä¹‰åˆçº§é˜¶æ®µ', 'å¸‚åœºç»æµä½“åˆ¶',
        'ä¸€å›½ä¸¤åˆ¶', 'æ¸¯æ¾³å›å½’', 'åŠ å…¥ä¸–è´¸ç»„ç»‡', 'ç§‘å­¦å‘å±•è§‚', 'å’Œè°ç¤¾ä¼š',
        'ä¸­å›½æ¢¦', 'æ–°æ—¶ä»£', 'å…¨é¢å»ºè®¾ç¤¾ä¼šä¸»ä¹‰ç°ä»£åŒ–å›½å®¶'
    ],

    // æ”¹é©å¼€æ”¾å²æ¦‚å¿µ
    reformHistory: [
        'æ”¹é©å¼€æ”¾', 'å®¶åº­è”äº§æ‰¿åŒ…è´£ä»»åˆ¶', 'ç»æµç‰¹åŒº', 'æ·±åœ³ç‰¹åŒº', 'æµ¦ä¸œå¼€å‘',
        'å›½æœ‰ä¼ä¸šæ”¹é©', 'ä»·æ ¼æ”¹é©', 'è´¢ç¨ä½“åˆ¶æ”¹é©', 'é‡‘èä½“åˆ¶æ”¹é©', 'æŠ•èµ„ä½“åˆ¶æ”¹é©',
        'å¤–è´¸ä½“åˆ¶æ”¹é©', 'å¤–æ±‡ä½“åˆ¶æ”¹é©', 'å¸‚åœºç»æµ', 'ç¤¾ä¼šä¸»ä¹‰å¸‚åœºç»æµä½“åˆ¶',
        'ç°ä»£ä¼ä¸šåˆ¶åº¦', 'è‚¡ä»½åˆ¶æ”¹é©', 'èµ„æœ¬å¸‚åœº', 'è‚¡ç¥¨å¸‚åœº', 'æœŸè´§å¸‚åœº',
        'å¯¹å¤–å¼€æ”¾', 'å¼•è¿›å¤–èµ„', 'ä¸‰èµ„ä¼ä¸š', 'è¿›å‡ºå£è´¸æ˜“', 'ç»æµå…¨çƒåŒ–',
        'äº§ä¸šç»“æ„è°ƒæ•´', 'åŒºåŸŸç»æµå‘å±•', 'è¥¿éƒ¨å¤§å¼€å‘', 'ä¸œåŒ—æŒ¯å…´', 'ä¸­éƒ¨å´›èµ·',
        'ä¸œéƒ¨ç‡å…ˆå‘å±•', 'æ–°å‹åŸé•‡åŒ–', 'åŸä¹¡å‘å±•ä¸€ä½“åŒ–', 'ä¾›ç»™ä¾§ç»“æ„æ€§æ”¹é©',
        'é«˜è´¨é‡å‘å±•', 'åˆ›æ–°é©±åŠ¨', 'æ–°æ—§åŠ¨èƒ½è½¬æ¢', 'æ”¾ç®¡æœæ”¹é©', 'è¥å•†ç¯å¢ƒ'
    ],

    // ç¤¾ä¼šä¸»ä¹‰å‘å±•å²æ¦‚å¿µ
    socialismHistory: [
        'ç©ºæƒ³ç¤¾ä¼šä¸»ä¹‰', 'ç§‘å­¦ç¤¾ä¼šä¸»ä¹‰', 'å…±äº§å…šå®£è¨€', 'å›½é™…å·¥äººè¿åŠ¨', 'å·´é»å…¬ç¤¾',
        'åæœˆé©å‘½', 'è‹è”æ¨¡å¼', 'ç¤¾ä¼šä¸»ä¹‰é˜µè¥', 'ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰', 'ç¤¾ä¼šä¸»ä¹‰åˆçº§é˜¶æ®µ',
        'ç¤¾ä¼šä¸»ä¹‰æœ¬è´¨', 'ç¤¾ä¼šä¸»ä¹‰æ ¹æœ¬ä»»åŠ¡', 'ç¤¾ä¼šä¸»ä¹‰å¸‚åœºç»æµ', 'æ°‘ä¸»ç¤¾ä¼šä¸»ä¹‰',
        'ç¤¾ä¼šæ°‘ä¸»ä¸»ä¹‰', 'åŒ—æ¬§æ¨¡å¼', 'ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰é“è·¯', 'ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰ç†è®ºä½“ç³»',
        'ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰åˆ¶åº¦', 'ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰æ–‡åŒ–', 'ç¤¾ä¼šä¸»ä¹‰ç°ä»£åŒ–',
        'å…±åŒå¯Œè£•', 'ç¤¾ä¼šå…¬å¹³æ­£ä¹‰', 'å’Œè°ç¤¾ä¼š', 'ç”Ÿæ€æ–‡æ˜', 'äººç±»æ–‡æ˜æ–°å½¢æ€',
        'å…¨è¿‡ç¨‹äººæ°‘æ°‘ä¸»', 'æ³•æ²»å›½å®¶', 'æ³•æ²»æ”¿åºœ', 'æ³•æ²»ç¤¾ä¼š', 'ç¤¾ä¼šæ²»ç†',
        'åŸºå±‚æ²»ç†', 'ç¤¾åŒºæ²»ç†', 'ä¹¡æ‘æ²»ç†', 'æ•°å­—æ²»ç†', 'æ™ºæ…§æ²»ç†'
    ],

    // ä¸­å…±å…šå²æ¦‚å¿µ
    ccpHistory: [
        'ä¸­å›½å…±äº§å…š', 'å…šçš„ä¸€å¤§', 'å…šçš„äºŒå¤§', 'å—æ˜Œèµ·ä¹‰', 'ç§‹æ”¶èµ·ä¹‰', 'äº•å†ˆå±±é©å‘½æ ¹æ®åœ°',
        'ä¸­å¤®çº¢å†›', 'éµä¹‰ä¼šè®®', 'å»¶å®‰æ•´é£', 'ä¸ƒå¤§', 'è¥¿æŸå¡', 'ä¸ƒå±ŠäºŒä¸­å…¨ä¼š', 'è¿›äº¬èµ¶è€ƒ',
        'æ–°ä¸­å›½æˆç«‹', 'æŠ—ç¾æ´æœ', 'åœŸåœ°æ”¹é©', 'ä¸‰å¤§æ”¹é€ ', 'å…«å¤§', 'å¤§è·ƒè¿›', 'äººæ°‘å…¬ç¤¾',
        'æ–‡åŒ–å¤§é©å‘½', 'åä¸€å±Šä¸‰ä¸­å…¨ä¼š', 'æ”¹é©å¼€æ”¾', 'ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰', 'åå››å¤§',
        'ç¤¾ä¼šä¸»ä¹‰å¸‚åœºç»æµä½“åˆ¶', 'åäº”å¤§', 'ä¸‰ä¸ªä»£è¡¨é‡è¦æ€æƒ³', 'åå…­å¤§', 'ç§‘å­¦å‘å±•è§‚',
        'åå…«å¤§', 'ä¹ è¿‘å¹³æ–°æ—¶ä»£ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰æ€æƒ³', 'åä¹å¤§', 'äºŒåå¤§', 'æ–°æ—¶ä»£',
        'å…šçš„é¢†å¯¼', 'å…šçš„å»ºè®¾', 'å…¨é¢ä»ä¸¥æ²»å…š', 'åè…è´¥æ–—äº‰', 'æ”¿æ²»å»ºè®¾', 'æ€æƒ³å»ºè®¾',
        'ç»„ç»‡å»ºè®¾', 'ä½œé£å»ºè®¾', 'çºªå¾‹å»ºè®¾', 'åˆ¶åº¦å»ºè®¾', 'åè…è´¥æ–—äº‰', 'å·¡è§†å·¥ä½œ',
        'ç›‘å¯Ÿä½“åˆ¶æ”¹é©', 'å›½å®¶ç›‘å¯Ÿå§”å‘˜ä¼š', 'å…šå†…ç›‘ç£', 'å…šå¤–ç›‘ç£', 'ç¾¤ä¼—ç›‘ç£',
        'èˆ†è®ºç›‘ç£', 'æ°‘ä¸»ç›‘ç£', 'äº’ç›¸ç›‘ç£'
    ],

    // æ€æƒ³é“å¾·ä¸æ³•æ²»æ¦‚å¿µ
    politicalEthics: [
        'æ€æƒ³é“å¾·', 'ç†æƒ³ä¿¡å¿µ', 'çˆ±å›½ä¸»ä¹‰', 'é›†ä½“ä¸»ä¹‰', 'ç¤¾ä¼šä¸»ä¹‰', 'ä¸ªäººå“å¾·',
        'å®¶åº­ç¾å¾·', 'èŒä¸šé“å¾·', 'ç¤¾ä¼šå…¬å¾·', 'æ³•æ²»ç²¾ç¥', 'æ³•å¾‹æ„è¯†', 'æ³•æ²»æ€ç»´',
        'å®ªæ³•æ„è¯†', 'æƒåˆ©æ„è¯†', 'ä¹‰åŠ¡è§‚å¿µ', 'å…¬å¹³æ­£ä¹‰', 'è‡ªç”±å¹³ç­‰', 'æ°‘ä¸»æ³•æ²»',
        'è¯šä¿¡å‹å–„', 'æ•¬ä¸šå¥‰çŒ®', 'åŠ©äººä¸ºä¹', 'è§ä¹‰å‹‡ä¸º', 'å­è€çˆ±äº²', 'å‹¤ä¿­èŠ‚çº¦',
        'è‰°è‹¦å¥‹æ–—', 'è‡ªå¼ºä¸æ¯', 'åšå¾·è½½ç‰©', 'è‡ªå¼ºä¸æ¯', 'æ ¼ç‰©è‡´çŸ¥', 'è¯šæ„æ­£å¿ƒ',
        'ä¿®èº«é½å®¶', 'æ²»å›½å¹³å¤©ä¸‹', 'ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚', 'å¯Œå¼ºæ°‘ä¸»æ–‡æ˜å’Œè°',
        'è‡ªç”±å¹³ç­‰å…¬æ­£æ³•æ²»', 'çˆ±å›½æ•¬ä¸šè¯šä¿¡å‹å–„', 'ä¸­åä¼˜ç§€ä¼ ç»Ÿæ–‡åŒ–', 'é©å‘½æ–‡åŒ–',
        'ç¤¾ä¼šä¸»ä¹‰å…ˆè¿›æ–‡åŒ–', 'æ–‡åŒ–è‡ªä¿¡', 'ç²¾ç¥æ–‡æ˜', 'ç‰©è´¨æ–‡æ˜', 'æ”¿æ²»æ–‡æ˜',
        'ç¤¾ä¼šæ–‡æ˜', 'ç”Ÿæ€æ–‡æ˜', 'å›½å®¶æ²»ç†', 'ç¤¾ä¼šæ²»ç†', 'åŸºå±‚æ²»ç†', 'ç¤¾åŒºæ²»ç†'
    ],

    // æ–°ä¸­å›½å²æ¦‚å¿µ
    newChinaHistory: [
        'ä¸­åäººæ°‘å…±å’Œå›½', 'å¼€å›½å¤§å…¸', 'å…±åŒçº²é¢†', 'åœŸåœ°æ”¹é©', 'æŠ—ç¾æ´æœ', 'é•‡å‹åé©å‘½',
        'ä¸‰åäº”å', 'ç¤¾ä¼šä¸»ä¹‰æ”¹é€ ', 'ç¬¬ä¸€ä¸ªäº”å¹´è®¡åˆ’', 'äººæ°‘ä»£è¡¨å¤§ä¼šåˆ¶åº¦', 'ä¸­å›½å…±äº§å…š',
        'é¢†å¯¼çš„å¤šå…šåˆä½œå’Œæ”¿æ²»åå•†åˆ¶åº¦', 'æ°‘æ—åŒºåŸŸè‡ªæ²»åˆ¶åº¦', 'å¤§è·ƒè¿›', 'äººæ°‘å…¬ç¤¾',
        'æ–‡åŒ–å¤§é©å‘½', 'ç²‰ç¢å››äººå¸®', 'åä¸€å±Šä¸‰ä¸­å…¨ä¼š', 'æ”¹é©å¼€æ”¾', 'å®¶åº­è”äº§æ‰¿åŒ…è´£ä»»åˆ¶',
        'ç»æµç‰¹åŒº', 'ç¤¾ä¼šä¸»ä¹‰åˆçº§é˜¶æ®µ', 'ç¤¾ä¼šä¸»ä¹‰å¸‚åœºç»æµ', 'é¦™æ¸¯å›å½’', 'æ¾³é—¨å›å½’',
        'åŠ å…¥ä¸–ç•Œè´¸æ˜“ç»„ç»‡', 'å…¨é¢å»ºè®¾å°åº·ç¤¾ä¼š', 'ç§‘å­¦å‘å±•è§‚', 'å’Œè°ç¤¾ä¼š', 'ä¸­å›½æ¢¦',
        'æ–°æ—¶ä»£ä¸­å›½ç‰¹è‰²ç¤¾ä¼šä¸»ä¹‰', 'å…¨é¢å»ºæˆå°åº·ç¤¾ä¼š', 'å…¨é¢å»ºè®¾ç¤¾ä¼šä¸»ä¹‰ç°ä»£åŒ–å›½å®¶',
        'ä¸¤ä¸ªä¸€ç™¾å¹´å¥‹æ–—ç›®æ ‡', 'ä¸­åæ°‘æ—ä¼Ÿå¤§å¤å…´', 'ä¸­å›½å¼ç°ä»£åŒ–', 'é«˜è´¨é‡å‘å±•',
        'å…±åŒå¯Œè£•', 'ä¹¡æ‘æŒ¯å…´', 'ç¾ä¸½ä¸­å›½', 'äººç±»å‘½è¿å…±åŒä½“'
    ]
};

// ä»QAæ•°æ®ä¸­æå–æ¦‚å¿µçš„å‡½æ•°
function extractConceptsFromQAData(qaData) {
    const concepts = new Set();
    const allPatterns = Object.values(politicalConceptPatterns).flat();

    // å°†æ‰€æœ‰æ¦‚å¿µæ¨¡å¼åŠ å…¥æ¦‚å¿µé›†åˆ
    allPatterns.forEach(concept => {
        concepts.add(concept);
    });

    qaData.forEach(item => {
        if (item.question) {
            // ä»é—®é¢˜æ–‡æœ¬ä¸­æå–æ¦‚å¿µ
            extractConceptsFromText(item.question, concepts);
        }

        if (item.options && Array.isArray(item.options)) {
            // ä»é€‰é¡¹ä¸­æå–æ¦‚å¿µ
            item.options.forEach(opt => {
                if (opt.content) {
                    extractConceptsFromText(opt.content, concepts);
                }
            });
        }
    });

    return Array.from(concepts);
}

// ä»æ–‡æœ¬ä¸­æå–æ¦‚å¿µçš„å‡½æ•°
function extractConceptsFromText(text, concepts) {
    const allPatterns = Object.values(politicalConceptPatterns).flat();

    allPatterns.forEach(concept => {
        // æ£€æŸ¥æ¦‚å¿µæ˜¯å¦åœ¨æ–‡æœ¬ä¸­å‡ºç°
        if (text.includes(concept)) {
            concepts.add(concept);
        }
    });

    // æå–ä¸€äº›å¸¸è§çš„æ”¿æ²»ç†è®ºæœ¯è¯­æ¨¡å¼
    const commonPatterns = [
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}ä¸»ä¹‰/g,  // å„ç§ä¸»ä¹‰
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}æ€æƒ³/g,  // å„ç§æ€æƒ³
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}ç†è®º/g,  // å„ç§ç†è®º
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}è§‚å¿µ/g,  // å„ç§è§‚å¿µ
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}æ„è¯†/g,  // å„ç§æ„è¯†
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}ç²¾ç¥/g,  // å„ç§ç²¾ç¥
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}ä»·å€¼/g,  // å„ç§ä»·å€¼
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}åˆ¶åº¦/g,  // å„ç§åˆ¶åº¦
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}ä½“åˆ¶/g,  // å„ç§ä½“åˆ¶
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}é“è·¯/g,  // å„ç§é“è·¯
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}æ–‡æ˜/g,  // å„ç§æ–‡æ˜
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}å»ºè®¾/g,  // å„ç§å»ºè®¾
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}å‘å±•/g,  // å„ç§å‘å±•
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}æ”¹é©/g,  // å„ç§æ”¹é©
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}é©å‘½/g,  // å„ç§é©å‘½
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}è¿åŠ¨/g,  // å„ç§è¿åŠ¨
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}æ–—äº‰/g,  // å„ç§æ–—äº‰
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}é˜¶çº§/g,  // å„ç§é˜¶çº§
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}æ”¿å…š/g,  // å„ç§æ”¿å…š
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}æ°‘ä¸»/g,  // å„ç§æ°‘ä¸»
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}æ³•æ²»/g,  // å„ç§æ³•æ²»
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}ç¤¾ä¼š/g,  // å„ç§ç¤¾ä¼š
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}ç»æµ/g,  // å„ç§ç»æµ
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}æ”¿æ²»/g,  // å„ç§æ”¿æ²»
        /[^ï¼Œã€‚ï¼ï¼Ÿ\s]{2,8}æ–‡åŒ–/g,  // å„ç§æ–‡åŒ–
    ];

    commonPatterns.forEach(pattern => {
        const matches = text.match(pattern);
        if (matches) {
            matches.forEach(match => {
                // è¿‡æ»¤æ‰å¤ªçŸ­æˆ–å¤ªé•¿çš„åŒ¹é…
                if (match.length >= 2 && match.length <= 10) {
                    concepts.add(match);
                }
            });
        }
    });
}

// å»é‡å’Œæ¸…ç†æ¦‚å¿µ
function cleanConcepts(concepts) {
    // ç§»é™¤ç©ºå€¼å’Œå¤ªçŸ­çš„æ¦‚å¿µ
    const cleaned = concepts.filter(concept =>
        concept &&
        typeof concept === 'string' &&
        concept.trim().length >= 2 &&
        concept.trim().length <= 20
    );

    // å»é‡
    const unique = [...new Set(cleaned.map(c => c.trim()))];

    // æŒ‰å­—æ•°æ’åºï¼ˆä¼˜å…ˆé€‰æ‹©æ ¸å¿ƒæ¦‚å¿µï¼‰
    return unique.sort((a, b) => {
        // ä¼˜å…ˆé€‰æ‹©4-8å­—çš„æ¦‚å¿µï¼ˆé€šå¸¸æ˜¯æ ¸å¿ƒæ¦‚å¿µï¼‰
        const aScore = getConceptScore(a);
        const bScore = getConceptScore(b);
        return bScore - aScore;
    });
}

// æ¦‚å¿µé‡è¦æ€§è¯„åˆ†
function getConceptScore(concept) {
    const length = concept.length;

    // æ ¸å¿ƒæ¦‚å¿µé€šå¸¸åœ¨4-8ä¸ªå­—
    if (length >= 4 && length <= 8) {
        return 10;
    } else if (length >= 2 && length <= 10) {
        return 5;
    } else {
        return 1;
    }
}

// ä¸»å¤„ç†å‡½æ•°
function extractSeedConcepts() {
    const inputFile = path.join(__dirname, 'transformed_political_data.json');
    const outputFile = path.join(__dirname, 'political_seed_concepts.json');
    const textOutputFile = path.join(__dirname, 'political_seed_concepts.txt');

    console.log('å¼€å§‹æå–æ”¿æ²»ç†è®ºç§å­æ¦‚å¿µ...\n');

    if (!fs.existsSync(inputFile)) {
        console.error(`è¾“å…¥æ–‡ä»¶ä¸å­˜åœ¨: ${inputFile}`);
        return;
    }

    // è¯»å–QAæ•°æ®
    const qaData = JSON.parse(fs.readFileSync(inputFile, 'utf8'));
    console.log(`è¯»å–åˆ° ${qaData.length} æ¡QAæ•°æ®`);

    // æå–æ¦‚å¿µ
    const rawConcepts = extractConceptsFromQAData(qaData);
    console.log(`åˆæ­¥æå–åˆ° ${rawConcepts.length} ä¸ªæ¦‚å¿µ`);

    // æ¸…ç†æ¦‚å¿µ
    const cleanedConcepts = cleanConcepts(rawConcepts);
    console.log(`æ¸…ç†åå¾—åˆ° ${cleanedConcepts.length} ä¸ªç§å­æ¦‚å¿µ`);

    // æŒ‰å­¦ç§‘åˆ†ç±»ç»Ÿè®¡
    const subjectStats = {};
    qaData.forEach(item => {
        const subject = item.subject_name || 'æœªçŸ¥';
        subjectStats[subject] = (subjectStats[subject] || 0) + 1;
    });

    console.log('\næŒ‰å­¦ç§‘ç»Ÿè®¡çš„QAæ•°æ®é‡:');
    Object.entries(subjectStats).forEach(([subject, count]) => {
        console.log(`${subject}: ${count} æ¡`);
    });

    // ä¿å­˜ä¸ºJSONæ ¼å¼
    const outputData = {
        metadata: {
            total_concepts: cleanedConcepts.length,
            source_qa_count: qaData.length,
            extraction_date: new Date().toISOString(),
            description: "æ”¿æ²»ç†è®ºç§å­æ¦‚å¿µåˆ—è¡¨ï¼Œç”¨äºæ¦‚å¿µå›¾è¿­ä»£æ‰©å¢"
        },
        seed_concepts: cleanedConcepts
    };

    fs.writeFileSync(outputFile, JSON.stringify(outputData, null, 2));

    // ä¿å­˜ä¸ºçº¯æ–‡æœ¬æ ¼å¼ï¼ˆä¾¿äºç›´æ¥ä½¿ç”¨ï¼‰
    const textContent = cleanedConcepts.join('\n');
    fs.writeFileSync(textOutputFile, textContent, 'utf8');

    console.log(`\nâœ… æå–å®Œæˆï¼`);
    console.log(`ğŸ“ JSONæ–‡ä»¶: ${outputFile}`);
    console.log(`ğŸ“„ æ–‡æœ¬æ–‡ä»¶: ${textOutputFile}`);
    console.log(`ğŸ“Š æ€»æ¦‚å¿µæ•°: ${cleanedConcepts.length}`);

    // æ˜¾ç¤ºå‰20ä¸ªæ¦‚å¿µä½œä¸ºæ ·ä¾‹
    console.log('\nğŸ“‹ å‰20ä¸ªç§å­æ¦‚å¿µæ ·ä¾‹:');
    cleanedConcepts.slice(0, 20).forEach((concept, index) => {
        console.log(`${index + 1}. ${concept}`);
    });

    return cleanedConcepts;
}

// å¦‚æœç›´æ¥è¿è¡Œæ­¤è„šæœ¬
if (require.main === module) {
    extractSeedConcepts();
}

module.exports = { extractSeedConcepts, extractConceptsFromQAData, politicalConceptPatterns };